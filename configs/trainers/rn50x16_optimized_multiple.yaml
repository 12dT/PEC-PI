# Configuration for MVSA-Multiple with Dual-Stream Contrastive Learning
# Full-stage caption introduction (STAGED.ENABLE: True)

DATALOADER:
  TRAIN_X:
    BATCH_SIZE: 128  
  TEST:
    BATCH_SIZE: 64
  NUM_WORKERS: 4

INPUT:
  SIZE: [384, 384]  
  INTERPOLATION: bicubic
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  TRANSFORMS: [random_flip]
  CROP_PADDING: 4

OPTIM:
  NAME: adamw
  LR: 0.0002  
  WEIGHT_DECAY: 0.01
  MAX_EPOCH: 100  
  LR_SCHEDULER: cosine
  WARMUP_EPOCH: 15
  WARMUP_TYPE: constant
  WARMUP_CONS_LR: 1e-5

TRAIN:
  PRINT_FREQ: 10
  CHECKPOINT_FREQ: 1

TRAINER:
  MAPLE:
    N_CTX: 16
    CTX_INIT: "a sentiment of"
    PREC: amp
    PROMPT_DEPTH: 9
    DUAL_STREAM:
      ENABLE: True
      ADAPTIVE_WEIGHT: True
      AUX_LOSS_WEIGHT: 0.3
    CAPTION_LOSS:
      ENABLE: True
      WEIGHT: 0.25
      TEMP: 2.5
      RAMP_EPOCHS: 15
      GATING:
        ENABLE: True
        THRESH: 0.35
      STAGED:
        ENABLE: True  
        ADAPTIVE:
          ENABLE: True
    FINETUNE_TEXT:
      ENABLE: True
      LAYERS: 2
      LR_MULT: 0.1

MODEL:
  BACKBONE:
    NAME: RN50x16

